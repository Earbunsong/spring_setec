<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/layout :: head">
</head>
<body>
<nav th:replace="fragments/layout :: navbar"></nav>

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <h2><i class="fas fa-user"></i> User Dashboard</h2>
      <p class="text-muted">Welcome, <span th:text="${username}">User</span>!</p>
    </div>
  </div>

  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5><i class="fas fa-chart-line"></i> Your Activity</h5>
        </div>
        <div class="card-body">
          <p>Here you can view your recent activity and statistics.</p>
          <div class="row text-center">
            <div class="col-md-4">
              <div class="border rounded p-3">
                <h4 class="text-primary">12</h4>
                <small>Orders</small>
              </div>
            </div>
            <div class="col-md-4">
              <div class="border rounded p-3">
                <h4 class="text-success">$1,240</h4>
                <small>Total Spent</small>
              </div>
            </div>
            <div class="col-md-4">
              <div class="border rounded p-3">
                <h4 class="text-info">85</h4>
                <small>Points</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-header">
          <h5><i class="fas fa-clock"></i> Recent Orders</h5>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table">
              <thead>
              <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Status</th>
                <th>Amount</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>#001</td>
                <td>2024-01-15</td>
                <td><span class="badge bg-success">Completed</span></td>
                <td>$125.00</td>
              </tr>
              <tr>
                <td>#002</td>
                <td>2024-01-10</td>
                <td><span class="badge bg-warning">Processing</span></td>
                <td>$89.50</td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h5><i class="fas fa-user-cog"></i> Profile</h5>
        </div>
        <div class="card-body" id="profileCard">
          <p><strong>Username:</strong> <span th:text="${username}">user</span></p>
          <p><strong>Role:</strong> <span th:text="${role}">User</span></p>
          <p><strong>Email:</strong> <span id="userEmail">Loading...</span></p>
          <div class="d-grid">
            <a href="/user/profile" class="btn btn-primary">
              <i class="fas fa-edit"></i> Edit Profile
            </a>
          </div>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-header">
          <h5><i class="fas fa-bell"></i> Notifications</h5>
        </div>
        <div class="card-body">
          <div class="list-group list-group-flush">
            <div class="list-group-item">
              <i class="fas fa-info-circle text-info"></i>
              Welcome to SecureApp!
            </div>
            <div class="list-group-item">
              <i class="fas fa-check-circle text-success"></i>
              Profile updated successfully
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Load user profile
  async function loadUserProfile() {
    try {
      const response = await fetch('/api/user/profile');
      const profile = await response.json();
      document.getElementById('userEmail').textContent = profile.email;
    } catch (error) {
      console.error('Error loading profile:', error);
    }
  }

  document.addEventListener('DOMContentLoaded', loadUserProfile);
</script>
</body>
</html>